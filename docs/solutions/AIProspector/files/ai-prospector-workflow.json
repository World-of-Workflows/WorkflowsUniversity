{"$id":"1","definitionId":"2c017bd2d114455ba8e39868d2662430","versionId":"89211b0a3b6d410a9330643ac84b227e","name":"RunGPT3","version":2,"variables":{"$id":"2","data":{}},"customAttributes":{"$id":"3","data":{}},"isSingleton":false,"persistenceBehavior":"Suspended","deleteCompletedInstances":false,"isPublished":true,"isLatest":true,"createdAt":"2023-03-04T23:43:19.9852049Z","activities":[{"$id":"4","activityId":"e36ce65c-5723-4ab1-9585-f4341144f981","type":"ObjectInstanceTrigger","name":"OIT","displayName":"Runs when a Lead is selected in the UI","x":720,"y":140,"persistWorkflow":false,"loadWorkflowContext":false,"saveWorkflowContext":false,"properties":[{"$id":"5","name":"ObjectTypeId","expressions":{"$id":"6","Literal":"1"}}],"propertyStorageProviders":{"$id":"7"}},{"$id":"8","activityId":"562dae72-e2bc-48d1-bd76-2a8a078325d5","type":"SetVariable","displayName":"Get the Response from ChatGPT","x":1300,"y":300,"persistWorkflow":false,"loadWorkflowContext":false,"saveWorkflowContext":false,"properties":[{"$id":"9","name":"VariableName","expressions":{"$id":"10","Literal":"GetMe"}},{"$id":"11","name":"Value","syntax":"JavaScript","expressions":{"$id":"12","JavaScript":"activities.GPTIII.ResponseContent()"}}],"propertyStorageProviders":{"$id":"13"}},{"$id":"14","activityId":"14aec22e-031e-4a44-b46e-40112c835eb4","type":"SetVariable","displayName":"Get Just the Response from ChatGPT","x":1520,"y":440,"persistWorkflow":false,"loadWorkflowContext":false,"saveWorkflowContext":false,"properties":[{"$id":"15","name":"VariableName","expressions":{"$id":"16","Literal":"GPTIIIRESPONSE"}},{"$id":"17","name":"Value","syntax":"JavaScript","expressions":{"$id":"18","JavaScript":"getVariable(\"GetMe\").choices[0].message.content"}}],"propertyStorageProviders":{"$id":"19"}},{"$id":"20","activityId":"cee02ecb-fca1-43a1-9c8a-ad6010b9fddc","type":"ObjectDetailReadToVariable","displayName":"Gets the current leads and places in ThisLead","x":1140,"y":140,"persistWorkflow":false,"loadWorkflowContext":false,"saveWorkflowContext":false,"properties":[{"$id":"21","name":"ObjectId","syntax":"JavaScript","expressions":{"$id":"22","JavaScript":"activities.OIT.InstanceId()"}},{"$id":"23","name":"State","expressions":{"$id":"24","Literal":"Current"}},{"$id":"25","name":"VariableName","expressions":{"$id":"26","Literal":"ThisLead"}}],"propertyStorageProviders":{"$id":"27"}},{"$id":"28","activityId":"fcdff773-1502-4da4-bd08-f91cbe3df6f1","type":"SendHttpRequest","name":"GetMe","displayName":"Send the Email from ChatGPT to Me","x":1540,"y":580,"persistWorkflow":false,"loadWorkflowContext":false,"saveWorkflowContext":false,"properties":[{"$id":"29","name":"Url","expressions":{"$id":"30","Literal":"https://graph.microsoft.com/v1.0/me/sendMail"}},{"$id":"31","name":"Method","expressions":{"$id":"32","Literal":"POST"}},{"$id":"33","name":"Content","syntax":"JavaScript","expressions":{"$id":"34","Liquid":"","JavaScript":"let text='{\"message\": {\"subject\": \"Introducing World of Workflows\",\"body\": {' +\r\n'\"contentType\": \"HTML\", \"content\": \"' + getVariable(\"GPTIIIRESPONSE\") +\r\n'\"},\"toRecipients\": [ { \"emailAddress\": { \"address\": \"nick@tribetech.com.au\" }}],' +\r\n' \"ccRecipients\": [ { \"emailAddress\": { \"address\": \"nick@releasedgroup.com\" } }] },'+\r\n'   \"saveToSentItems\": \"true\"}';\r\nreturn text;"}},{"$id":"35","name":"ContentType","expressions":{"$id":"36","Literal":"application/json"}},{"$id":"37","name":"ReadContent","expressions":{"$id":"38","Literal":"true"}},{"$id":"39","name":"ResponseContentParserName","expressions":{"$id":"40","Literal":""}},{"$id":"41","name":"ResponseContentTargetType","expressions":{"$id":"42"}},{"$id":"43","name":"SupportedStatusCodes","expressions":{"$id":"44","Json":"[\"202\"]"}},{"$id":"45","name":"Authorization","expressions":{"$id":"46","Secret":"OAuth2:O365"}},{"$id":"47","name":"RequestHeaders","expressions":{"$id":"48"}}],"propertyStorageProviders":{"$id":"49"}},{"$id":"50","activityId":"1fe5781c-b381-472f-874e-2aca6bbb21d9","type":"Finish","displayName":"Finish - Failed","x":1240,"y":640,"persistWorkflow":false,"loadWorkflowContext":false,"saveWorkflowContext":false,"properties":[{"$id":"51","name":"ActivityOutput","expressions":{"$id":"52"}},{"$id":"53","name":"OutcomeNames","expressions":{"$id":"54","Json":"[\"Failed\"]"}}],"propertyStorageProviders":{"$id":"55"}},{"$id":"56","activityId":"e3d4daac-162a-4898-85d0-b3e01a7177fe","type":"SendHttpRequest","name":"GPTIII","displayName":"Send Request to ChatGPT","x":1680,"y":280,"persistWorkflow":false,"loadWorkflowContext":false,"saveWorkflowContext":false,"properties":[{"$id":"57","name":"Url","expressions":{"$id":"58","Literal":"https://api.openai.com/v1/chat/completions"}},{"$id":"59","name":"Method","expressions":{"$id":"60","Literal":"POST"}},{"$id":"61","name":"Content","syntax":"JavaScript","expressions":{"$id":"62","JavaScript":"let text='{\"model\": \"gpt-3.5-turbo\", \"messages\": [{\"role\": \"user\", \"content\": \"' +\r\ngetVariable(\"ThisLead\").ProspectDescription + ' Write him a html email telling him how good our new business automation tool, World of Workflows is.\"}]}';\r\nreturn text;","Liquid":""}},{"$id":"63","name":"ContentType","expressions":{"$id":"64","Literal":"application/json"}},{"$id":"65","name":"ReadContent","expressions":{"$id":"66","Literal":"true"}},{"$id":"67","name":"ResponseContentParserName","expressions":{"$id":"68","Literal":""}},{"$id":"69","name":"ResponseContentTargetType","expressions":{"$id":"70"}},{"$id":"71","name":"SupportedStatusCodes","expressions":{"$id":"72","Json":"[\"200\"]"}},{"$id":"73","name":"Authorization","expressions":{"$id":"74","Secret":"Authorization:GPT3"}},{"$id":"75","name":"RequestHeaders","expressions":{"$id":"76"}}],"propertyStorageProviders":{"$id":"77"}},{"$id":"78","activityId":"12e47828-3aab-47fe-9c08-38fd990be092","type":"Finish","displayName":"Finish - Success","x":960,"y":480,"persistWorkflow":false,"loadWorkflowContext":false,"saveWorkflowContext":false,"properties":[{"$id":"79","name":"ActivityOutput","expressions":{"$id":"80"}},{"$id":"81","name":"OutcomeNames","expressions":{"$id":"82","Json":"[\"Success\"]"}}],"propertyStorageProviders":{"$id":"83"}}],"connections":[{"$id":"84","sourceActivityId":"e3d4daac-162a-4898-85d0-b3e01a7177fe","targetActivityId":"562dae72-e2bc-48d1-bd76-2a8a078325d5","outcome":"200"},{"$id":"85","sourceActivityId":"562dae72-e2bc-48d1-bd76-2a8a078325d5","targetActivityId":"14aec22e-031e-4a44-b46e-40112c835eb4","outcome":"Done"},{"$id":"86","sourceActivityId":"e36ce65c-5723-4ab1-9585-f4341144f981","targetActivityId":"cee02ecb-fca1-43a1-9c8a-ad6010b9fddc","outcome":"Done"},{"$id":"87","sourceActivityId":"cee02ecb-fca1-43a1-9c8a-ad6010b9fddc","targetActivityId":"e3d4daac-162a-4898-85d0-b3e01a7177fe","outcome":"Success"},{"$id":"88","sourceActivityId":"14aec22e-031e-4a44-b46e-40112c835eb4","targetActivityId":"fcdff773-1502-4da4-bd08-f91cbe3df6f1","outcome":"Done"},{"$id":"89","sourceActivityId":"fcdff773-1502-4da4-bd08-f91cbe3df6f1","targetActivityId":"12e47828-3aab-47fe-9c08-38fd990be092","outcome":"202"},{"$id":"90","sourceActivityId":"fcdff773-1502-4da4-bd08-f91cbe3df6f1","targetActivityId":"1fe5781c-b381-472f-874e-2aca6bbb21d9","outcome":"Unsupported Status Code"}],"id":"89211b0a3b6d410a9330643ac84b227e"}